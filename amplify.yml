version: 1
applications:
  - appRoot: softcomputers-site
    frontend:
      phases:
        preBuild:
          commands:
            - npm ci
        build:
          commands:
            - npm run build
            - |
              cat > out/required-server-files.json << 'EOF'
              {
                "version": 3,
                "routes": {
                  "pages": {},
                  "dataRoutes": {},
                  "dynamicRoutes": []
                },
                "hasCustomAppGetInitialProps": false,
                "hasMiddleware": false
              }
              EOF
            - |
              cat > out/server-trace.json << 'EOF'
              []
              EOF
            - |
              cat > out/server-trace-manifest.json << 'EOF'
              []
              EOF
            - ls -la out/ | head -20
            - ls -la out/.next/ 2>/dev/null || echo "No .next directory"
      artifacts:
        baseDirectory: out
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*

